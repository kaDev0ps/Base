# Kubernetes

Это Оркестратор контейнеров для их управления.
Тоесть при увеличении нагрузки на сервер автоматически создаются новые сервера и с помощью балансировщика некоторые контейнеры запускаются на них, чтобы уменьшиь общую нагрузку.

# Главные принципы

1. Не изменяемости - мы можем ноду, которая неправильно работает вывести из обслуживания и ввести новую. Мы не лечим, а пересоздаем.
2. Описательный - Управление конфигурацией как кодом
3. Самоисцеляющий - перезагружаются контейнеры и приложения работает

# Как оно работает

Мастеров 1-3-5-7
Ноды - рабочие машины

Подключаемся через графические (UI) или консольные (CLI) утилиты к мастеру и работа ведется на мастерах.

# Workflow

Через API к мастер-серверу подключаются все компоненты. Со storage и БД он работает напрямую.

app:
image: myimg
replicas: 2

передаем челез CLI в мастер-сервер информацию, что наше приложение будет запускаться из образа myimage и будет иметь 2 реплики. Мастер сервер поднимает 2 экземпляра на node-1 и node-3. Мы не описываем как, мы описываем, что мы хотим сделать.

# Pod

1. Минимальная еденица Kubernetes
2. Состоит из 2 контейнеров
3. Содержит основное описание приложения

# Pod вместо контейнеров это правильно в кибернетесе

kubectl - основная команда работа с podами
можно сделать алиас kubectl = k

# Команды кибернетиса

<!-- Получить список нодов -->

kubectl get node

<!-- Создать под из файла -->

kubectl create -f pod.yaml

<!-- Получить список подов -->

kubectl get pod

<!-- Проксируем порты -->

kubectl port-forward my-pod 8888:80

<!-- Справка -->

kubectl port-forward --help

# replicaset

С помощью этой команды мы можем находить наше приложение в кластере

<!-- Показать поды и IP Расширенный вывод-->

kubectl get pod -o wide

<!-- Показать поды и IP -->

kubectl get pod --show-labels

<!-- Показать поды и IP -->

kubectl apply -f replicaset.yaml

<!--
apply - можно применить настройки к существующему приложению
Просмотр наших реплик -->

kubectl get replicaset

<!-- Указываем сколько реплик нужно -->

kubectl scale replicaset my-replicaset --replicas=2
